# ステアリングファイル作成ガイドライン

## 目的

ステアリングファイルは、Kiro の動作を導くためのガイドラインを提供する。このドキュメントは、ステアリングファイルを作成・更新する際の原則を定義する。

## 基本原則

### 適用範囲

このガイドラインは、**ステアリングファイル自体の文章**に適用する。ステアリングファイルが指示する成果物（README、コード、設定ファイル等）には適用しない。

### 1. 事実を淡々と述べる

ステアリングファイルの文章では、強調表現を避け、事実を明確に記述する。

#### 避けるべき表現
- ❌ 「必須」「絶対」「必ず」「重要」
- ❌ 「推奨」「ベストプラクティス」
- ❌ 「警告」「危険」「注意」
- ❌ セクションタイトルの括弧書き：「〜（必須）」「〜（推奨）」

#### 使用すべき表現
- ✅ 事実の記述：「〜する」「〜してはならない」
- ✅ 条件の明示：「〜の場合、〜する」
- ✅ 結果の記述：「〜すると、〜になる」

#### 例

**悪い例：**
```markdown
### データベース選択（必須）

**重要**: データベースを選択する際は、以下を確認する
```

**良い例：**
```markdown
### データベース選択

データベースを選択する際は、以下を確認する
```

### 2. 条件を明確にする

ルールが適用される条件を明示する。

#### 条件の記述方法

**条件付きルール：**
```markdown
デプロイボタンがある場合、Prerequisites セクションを含める
```

**無条件ルール：**
```markdown
コミットされていない変更を含むディレクトリを削除してはならない
```

**不明な場合：**
```markdown
不明な場合は、ユーザーに確認する
```

### 3. 重複を避ける

同じ内容を複数のファイルに記載しない。

#### 重複チェック
- 新しいステアリングを追加する前に、既存ファイルを確認
- 関連する内容は同一ファイルにまとめる
- 他ファイルの内容を参照する場合は明示的に記載

#### 例
```markdown
ブランチ戦略の詳細は `development-guidelines.md` を参照
```

### 5. 冗長性を排除する

一般的に知られている事項や事実は書き連ねない。

#### 削除すべき内容
以下の条件をすべて満たす内容は削除する：
- 一般的な知識である
- Kiro が学習済みである
- 解が1つしかない（業界標準）

#### 残すべき内容
以下のいずれかに該当する内容は残す：
- プロジェクト固有のルール
- Kiro が間違えやすい内容
- 複数の選択肢がある内容

#### 例

**削除すべき:**
- Git の基本的なコマンド（`git status`, `git commit`）
- テストの目的（バグの早期発見、リファクタリングの安全性）
- SOLID原則、DRY原則などの一般的な設計原則
- AWS の基本的なベストプラクティス（サーバーレスファースト等）

**残すべき:**
- main ブランチへの直接コミット禁止（プロジェクト固有）
- MCP でドキュメント確認（Kiro が間違えやすい）
- 複数の実装方法の比較（選択肢がある）
- サブモジュール操作の詳細手順（間違えやすい）

### 6. 特定の事象に依存しない

過去の特定の事象のみを捉えた反省や教訓は記載しない。

#### 避けるべき内容
- 特定の日時に発生した問題の詳細
- 特定のプロジェクトでのみ発生した問題
- 「今回の教訓」「発生した問題」などのセクション

#### 理由
- 時間が経つと文脈が失われる
- 他のプロジェクトには適用できない
- 一般化されたルールの方が有用

#### 対応方法
特定の事象から学んだ内容は、一般化されたルールとして記載する。

**悪い例:**
```markdown
## 今回の教訓

### 発生した問題
1. サブモジュールのリモート設定を変更しようとした
2. 設定変更がうまくいかず、`rm -rf steering` を実行
3. ローカルの変更が完全に失われた
```

**良い例:**
```markdown
## サブモジュール操作の原則

### サブモジュールの削除

サブモジュールの削除は、ローカルの変更を完全に失う可能性がある

#### 削除手順
1. サブモジュール内の変更を確認
2. 未コミットの変更がある場合はコミット
3. リモートに Push
```

### 4. 分類と整理

ステアリングファイルは機能別に分類する。

#### 分類の判断フロー

```
新しいステアリング内容を追加する
  ↓
既存のカテゴリに当てはまるか？
  YES → 既存ファイルに統合（「新規内容の追加」参照）
  NO  → 最も近いカテゴリに統合
```

## 文章スタイル

### 箇条書き

**シンプルなリスト：**
```markdown
- 項目1
- 項目2
- 項目3
```

**チェックリスト：**
```markdown
- [ ] 確認項目1
- [ ] 確認項目2
```

**良い例・悪い例：**
```markdown
- ❌ 悪い例
- ✅ 良い例
```

## 内容の構成

### 基本構成

```markdown
# タイトル

## 基本原則

[原則の説明]

## 具体的な手順

[手順の説明]

## チェックリスト

[確認項目]
```

わかりにくい場合のみ「例」セクションを追加する。

### セクションの順序

1. **原則**: 基本的な考え方
2. **手順**: 具体的な実行方法
3. **チェックリスト**: 確認項目
4. **例**: 具体的な使用例（わかりにくい場合のみ）
5. **トラブルシューティング**: 問題発生時の対応（該当する場合）

## 禁止事項

以下はステアリングファイル自体の文章に適用する。文例やサンプルコードには適用しない。

### 1. 主観的な表現

```markdown
❌ 「〜が良い」「〜がベスト」「〜が望ましい」
✅ 「〜する」「〜の場合、〜する」
```

### 2. 曖昧な表現

```markdown
❌ 「適切に」「十分に」「なるべく」
✅ 具体的な基準を記載
```

### 3. 過度な強調

```markdown
❌ **重要**: 必ず〜してください！！
✅ 〜する
```

### 4. 冗長な説明

```markdown
❌ 非常にことですが、確認してください。これは絶対に守るべきルールです。
✅ 確認する
```

## ステアリングファイルの操作

### 新規内容の追加

新しいステアリング内容を追加する際の手順（「分類の判断フロー」の YES の場合）：

1. **カテゴリ判断**: 追加内容が既存のカテゴリのどれに属するか判断
2. **ファイル統合**: 該当するファイルに内容を追加
3. **重複排除**: 既存内容との重複を確認し、削除
4. **一貫性確保**: 統合後のファイル全体の構成と内容を確認
5. **個別ファイル削除**: 一時的に作成した個別ファイルがあれば削除

例：
```
「Git サブモジュールの操作方法」を追加する場合：
1. カテゴリ判断 → git-operations-guidelines.md に該当
2. ファイル統合 → git-operations-guidelines.md に追加
3. 重複排除 → 既存の Git 操作説明と重複がないか確認
4. 一貫性確保 → セクション順序や文章スタイルを統一
5. 個別ファイル削除 → git-submodule-guidelines.md があれば削除
```

### 既存内容の更新

既存のステアリングファイルを更新する際の手順：

1. **対象ファイル特定**: 更新する内容がどのファイルに含まれるか確認
2. **内容更新**: 該当セクションを更新
3. **クリーンアップ**: 不要になった記載を削除
4. **一貫性確保**: ファイル全体の整合性を確認

例：
```markdown
❌ 古い仕様と新しい仕様が両方記載されている
✅ 新しい仕様のみが記載されている
```

## チェックリスト

### 新規作成時
- [ ] 既存ファイルに統合できないか確認
- [ ] 強調表現を使用していない
- [ ] 条件を明確に記述している
- [ ] 重複する内容がない
- [ ] 適切なカテゴリに分類されている

### 更新時
- [ ] 不要な記載を削除した
- [ ] 新しい内容が既存構造に統合されている
- [ ] 強調表現を追加していない
- [ ] 他ファイルとの整合性を確認した

### レビュー時
- [ ] 事実を淡々と述べているか
- [ ] 条件が明確か
- [ ] 重複がないか
- [ ] 分類が適切か
- [ ] 文章スタイルが統一されているか