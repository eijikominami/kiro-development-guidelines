---
inclusion: always
---

# プロジェクト構造ガイドライン

## ディレクトリ構造

```
project-root/
├── .kiro/
│   ├── specs/[project-name]/    # 仕様書（requirements.md, design.md, tasks.md）
│   └── steering/                # ステアリングファイル（共通管理）
├── [project-name]/              # プロジェクトソースコード
└── sam-app/                     # SAM テンプレート（該当する場合）
    ├── template.yaml            # 親スタック
    └── [service-name].yaml      # 子スタック
```

## マルチプロジェクト環境での操作

複数プロジェクトが開いている場合、ファイル操作・コマンド実行前に対象プロジェクトを確認する。

確認事項：
- `.kiro/specs/[project-name]/` から対応するプロジェクトディレクトリを特定
- ファイルパスがプロジェクトディレクトリ内であることを確認
- `sam deploy` 等のコマンドは正しいディレクトリで実行

## ステアリングファイル管理

### ファイル構成

| ファイル | 内容 |
|---------|------|
| `project-structure.md` | ディレクトリ構造、ファイル管理 |
| `development-guidelines.md` | 技術スタック、ビルド、開発プロセス |
| `aws-architecture.md` | AWS サービス、CloudFormation |
| `communication-guidelines.md` | 応答ルール、文書作成 |
| `product-guidelines.md` | UI/UX、データ管理、運用 |

### 追加・更新ルール

新しいステアリング内容は既存ファイルに統合する。個別ファイルを作成しない。

手順：
1. 内容が属するカテゴリを判断
2. 該当ファイルに統合
3. 重複を排除
4. 一時ファイルがあれば削除

## 機密情報管理

### リポジトリ分離

| 種類 | 配置先 |
|-----|-------|
| テンプレート、サンプル、ドキュメント | パブリックリポジトリ |
| 設定値、認証情報、内部手順 | プライベートリポジトリ |
| API キー、シークレット | AWS Secrets Manager |

### パブリックリポジトリで禁止

- 実際の設定値（Account ID、Property ID 等）
- 認証情報（OAuth Client Secret、API Key 等）
- 内部システムのパス
- 機密性の高い運用手順

### 設定ファイル管理

`samconfig.toml` 等の設定ファイルはプライベートリポジトリで管理する。

フロー：
1. 開発時：プライベートリポジトリから取得
2. デプロイ時：ワーキングディレクトリにコピー
3. デプロイ後：削除（.gitignore で除外）

### design.md への記載

設計書には以下を含める：
- プロジェクト構造（ディレクトリパスと役割）
- リポジトリ構成（パブリック・プライベート分離）
- 設定ファイル管理方法
- セキュリティ考慮事項
